"use strict";(self.webpackChunkcare_ops_frontend=self.webpackChunkcare_ops_frontend||[]).push([[891],{8172:(e,t,o)=>{o.r(t),o.d(t,{startFormApp:()=>T}),o(3923);var r=o(7198),s=o(5291),n=o.n(s),i=o(8088),a=o.n(i),m=o(9230),d=o.n(m),u=o(9620),c=o(7201),l=o(2182),p=o(3309);const f=Formio.Displays.displays.webform.prototype.init;Formio.Displays.displays.webform.prototype.init=function(){if(this.options.data){const e=(0,r.extend)({},this.options.data);this._submission={data:e},this._data=e}f.call(this)};const h=Formio.Evaluator.evaluator;Formio.Evaluator.evaluator=function(e){try{for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];return h(e,...o)}catch(e){p.v.addError(e)}};const v=Formio.Evaluator.evaluate;function g(e,t,o,s){return Formio.createForm(document.createElement("div"),{},{evalContext:s}).then((s=>{const n=(0,r.reduce)(o,((t,o)=>FormioUtils.evaluate(o,s.evalContext({formSubmission:t,formData:e}))||t),t);return s.destroy(),n}))}Formio.Evaluator.evaluate=function(e){try{for(var t=arguments.length,o=new Array(t>1?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];return v(e,...o)}catch(e){p.v.addError(e)}};const y=Formio.Components.components.nested,b=Formio.Components.components.select;class w extends Formio.Components.components.survey{get emptyValue(){return[]}}Formio.Components.components.survey=w;class F extends b{static schema(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return b.schema({label:"Directory",key:"directory",type:"directory",dataSrc:"custom",searchField:!0,customOptions:{noChoicesText:"Type a minimum of 3 characters for results"}},...t)}get defaultSchema(){return F.schema()}constructor(){super(...arguments),this.updateCustomItems=(0,r.debounce)(this.updateCustomItems,300)}updateItems(e,t){this.visible?this.updateCustomItems(t,e):this.itemsLoadedResolve()}getCustomItems(e){return!e||e.length<3?Promise.resolve([]):this.evaluate(this.component.data.custom,{values:[],searchInput:e},"values")}updateCustomItems(e,t){e||this.active?(this.loading=!0,this.getCustomItems(t).then((e=>{this.loading=!1,this.setItems(e||[])})).catch((e=>{this.handleLoadingError(e)}))):this.itemsLoadedResolve()}}let C,x;function S(){window.scrollTo({top:0})}function E(e,t){return C.request("fetch:directory",{directoryName:e,query:t})}function I(e){return function(e,t){return Formio.createForm(document.createElement("div"),{}).then((o=>{const s=(0,r.reduce)(e,((e,t)=>(0,r.extend)({},e,FormioUtils.evaluate(t,o.evalContext(e)))),t);return o.destroy(),s}))}(e,{getDirectory:E,Handlebars:d(),TEMPLATES:{},parsePhoneNumber:u._})}Formio.use({components:{snippet:class extends y{constructor(){super(...arguments),this.noField=!0}static schema(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return y.schema({label:"Snippet",key:"snippet",type:"snippet",components:[],input:!1,persistent:!1,snippet:null},...t)}},directory:F}});const _=function(e,t){const o=function(e,t,o,s){return(0,r.reduce)(t,((t,o)=>{const r=e.evalContext({formSubmission:t,prevSubmission:s});return r.hasChanged=FormioUtils.evaluate("return function hasChanged(key) { return !_.isEqual(_.get(formSubmission, key), _.get(prevSubmission, key)); }",r),FormioUtils.evaluate(o,r)||t}),o)}(e,t,structuredClone(e.submission.data),x);e.data=o,e.setSubmission({data:o},{fromChangeReducers:!0,fromSubmission:!1}),x=structuredClone(e.submission.data)},P=(0,r.debounce)(_,100),q=(0,r.debounce)((function(e){C.request("update:storedSubmission",e)}),2e3);async function k(e){let{definition:t,storedSubmission:o,formData:s,formSubmission:n,reducers:i,changeReducers:a,contextScripts:m,beforeSubmit:d}=e;const u=await I(m),c=o||await g(s,n,i,u);x=structuredClone(c);const l=await Formio.createForm(document.getElementById("root"),t,{evalContext:u,data:c,onChange(e,t){let{fromChangeReducers:o}=e,{instance:r}=t;o&&l.initialized||r&&r.inEditGrid||(q(l.submission.data),P(l,a))}});l.nosubmit=!0,C.off("form:submit"),C.off("form:errors"),C.on({"form:errors"(e){l.showErrors((0,r.map)(e,(e=>({message:e}))),!0)},"form:submit"(){l.submit()}}),l.on("prevPage",S),l.on("nextPage",S),l.on("error",(()=>{C.request("ready:form")})),l.on("submit",(e=>{if(P.cancel(),_(l,a),l.setPristine(!1),!l.checkValidity(e.data,!0,e.data))return void l.emit("error");const t=FormioUtils.evaluate(d,l.evalContext({formSubmission:e.data}))||{};C.request("submit:form",{response:(0,r.extend)({},e,{data:t})})})),C.request("ready:form")}async function R(e){let{definition:t,contextScripts:o}=e;const s=await I(o);(0,r.extend)(s,{isPreview:!0}),Formio.createForm(document.getElementById("root"),t,{evalContext:s})}async function D(e){let{definition:t,formSubmission:o,contextScripts:s}=e;const n=await I(s);(0,r.extend)(n,{isResponse:!0}),Formio.createForm(document.getElementById("root"),t,{readOnly:!0,renderMode:"form",evalContext:n,data:o}).then((e=>{e.on("prevPage",S),e.on("nextPage",S)}))}async function A(e){let{definition:t,formData:o,formSubmission:r,reducers:s,contextScripts:n}=e;const i=await I(n),a=await g(o,r,s,i);(await Formio.createForm(document.getElementById("root"),t,{evalContext:i,data:a})).nosubmit=!0}const L=a().Router.extend({initialize(){window.addEventListener("message",(e=>{let{data:t,origin:o}=e;o===window.origin&&t&&t.message&&this.trigger(t.message,t.args)}),!1),n()(window).on("focus",(()=>{this.request("focus")})),this.request("version",l.dd.frontend)},request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((o=>{this.once(e,o),parent.postMessage({message:e,args:t},window.origin)}))},routes:{"formapp/":"renderForm","formapp/preview":"renderPreview","formapp/:id":"renderResponse","formapp/pdf/:formId/:patientId(/:responseId)":"renderPdf"},renderForm(){this.request("fetch:form:data").then(k)},renderPreview(){this.request("fetch:form").then(R)},renderResponse(e){this.request("fetch:form:response",{responseId:e}).then(D)},renderPdf(e,t,o){this.once("form:pdf",A),n()("body").append(`<iframe class="iframe-hidden" src="/formservice/${e}/${t}${o?`/${o}`:""}"></iframe>`)}});function T(){n()("#root").append(`\n    <div class="loader__bar js-progress-bar">\n      <div class="loader__bar-progress--loop"></div>\n    </div>\n    <div class="loader__text js-loading">${c.ZP.regions.preload.loading}</div>\n  `),C=new L,a().history.start({pushState:!0})}}}]);